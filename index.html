<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SYF-CBTS Spin & Quiz</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f3f4f6;
        }

        .wheel-container {
            position: relative;
            width: 350px;
            height: 350px;
            margin: 0 auto;
        }

        canvas {
            width: 100%;
            height: 100%;
            transition: transform 0.1s;
        }

        .pointer {
            position: absolute;
            top: 50%;
            right: -20px;
            transform: translateY(-50%);
            width: 0;
            height: 0;
            border-top: 20px solid transparent;
            border-bottom: 20px solid transparent;
            border-right: 30px solid #1f2937;
            /* Pointing left */
            z-index: 10;
        }

        /* Hide scrollbar for clean look */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }

        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .answer-panel {
            transition: max-height 0.3s ease-out, opacity 0.3s ease-out, padding 0.3s ease;
            max-height: 0;
            opacity: 0;
            overflow: hidden;
        }

        .answer-panel.open {
            max-height: 200px;
            opacity: 1;
            padding-top: 0.75rem;
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .locked-overlay {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(2px);
        }
        .bg-cbts-900 {
    --tw-bg-opacity: 1;
    background-color: #1F3558;
}
    </style>
</head>

<body class="text-gray-800 min-h-screen flex flex-col">

    <!-- Header -->
    <header class="bg-cbts-900 text-white p-4 shadow-lg">
        <div class="max-w-5xl mx-auto flex justify-between items-center">
            <div class="flex items-center gap-2">
                <i data-lucide="circle-dashed" class="w-8 h-8 text-pink-500"></i>
                <h1 class="text-2xl font-bold tracking-wider">SYF-CBTS SPIN & QUIZ</h1>
            </div>
            <button onclick="resetGame()"
                class="text-sm bg-indigo-700 hover:bg-indigo-600 px-4 py-2 rounded-lg border border-indigo-500 transition flex items-center gap-2">
                <i data-lucide="rotate-ccw" class="w-4 h-4"></i> Reset
            </button>
        </div>
    </header>

    <main class="flex-grow p-4 md:p-8 max-w-6xl mx-auto w-full grid grid-cols-1 lg:grid-cols-2 gap-8 items-start">

        <!-- Left Column: The Wheel -->
        <section class="flex flex-col items-center bg-white p-6 rounded-2xl shadow-xl border-t-4 border-indigo-500">
            <div class="w-full flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold text-gray-700 flex items-center gap-2">
                    <span
                        class="bg-indigo-100 text-indigo-700 w-8 h-8 rounded-full flex items-center justify-center text-sm">1</span>
                    Spin the Wheel
                </h2>
                <!-- Edit Names Toggle -->
                <button onclick="toggleEdit()" class="text-xs text-gray-500 hover:text-indigo-600 underline">Edit
                    Names</button>
            </div>

            <!-- Edit Panel (Hidden by default) -->
            <div id="editPanel" class="hidden w-full mb-4 bg-gray-50 p-4 rounded-lg border border-gray-200">
                <h3 class="text-sm font-semibold mb-2">Player Names</h3>
                <div class="grid grid-cols-2 gap-2 mb-2">
                    <input type="text" class="name-input border rounded p-2 text-sm" value="Incident Dectectives">
                    <input type="text" class="name-input border rounded p-2 text-sm" value="Network Ninja">
                    <input type="text" class="name-input border rounded p-2 text-sm" value="Automation Avengers">
                    <input type="text" class="name-input border rounded p-2 text-sm" value="SharePoint Smashers">
                    <input type="text" class="name-input border rounded p-2 text-sm" value="Cloud Commanders">

                </div>
                <button onclick="updateNames()"
                    class="w-full bg-gray-800 text-white py-2 rounded text-sm hover:bg-gray-900">Update Wheel</button>
            </div>

            <div class="wheel-container mb-6">
                <canvas id="wheelCanvas" width="500" height="500"></canvas>
                <div class="pointer"></div>
            </div>

            <button id="spinBtn" onclick="spinWheel()"
                class="w-full max-w-xs bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white font-bold py-3 px-8 rounded-full shadow-lg transform transition hover:scale-105 active:scale-95 text-lg flex items-center justify-center gap-2">
                <i data-lucide="dices" class="w-5 h-5"></i> SPIN NOW
            </button>

            <div id="result"
                class="h-8 mt-4 text-xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-indigo-600 to-purple-600 text-center transition-all duration-300">
            </div>
        </section>

        <!-- Right Column: The Questions (Locked initially) -->
        <section id="question-section"
            class="relative flex flex-col bg-white rounded-2xl shadow-xl overflow-hidden min-h-[400px] transition-all duration-500 border-t-4 border-gray-300">

            <!-- Header for Question Section -->
            <div id="question-header" class="p-6 border-b border-gray-100 transition-colors duration-300">
                <div class="flex justify-between items-center">
                    <h2 class="text-xl font-bold text-gray-700 flex items-center gap-2">
                        <span
                            class="bg-gray-100 text-gray-600 w-8 h-8 rounded-full flex items-center justify-center text-sm transition-colors duration-300"
                            id="step-2-badge">2</span>
                        <span id="q-title-text">Questions Panel</span>
                    </h2>
                    <span id="player-badge"
                        class="hidden text-xs font-bold uppercase tracking-wider text-white px-3 py-1 rounded-full shadow-sm">
                        <!-- Player Name Injected Here -->
                    </span>
                </div>
                <p id="q-subtitle" class="text-sm text-gray-500 mt-2">Spin the wheel to assign questions to a player.
                </p>
            </div>

            <!-- Content Area -->
            <div class="relative flex-grow p-6 bg-gray-50">

                <!-- Locked State Overlay -->
                <div id="locked-state"
                    class="absolute inset-0 z-10 flex flex-col items-center justify-center text-center p-6 bg-white/50 backdrop-blur-sm">
                    <div class="bg-white p-4 rounded-full shadow-md mb-3">
                        <i data-lucide="lock" class="w-8 h-8 text-gray-400"></i>
                    </div>
                    <h3 class="text-lg font-semibold text-gray-600">Waiting for Spinner...</h3>
                    <p class="text-sm text-gray-400 max-w-xs mt-1">Spin the wheel to find out who needs to answer these
                        questions!</p>
                </div>

                <!-- Questions List (Hidden initially) -->
                <div id="questions-list" class="space-y-3 hidden">
                    <!-- Questions injected here by JS -->
                </div>
            </div>
        </section>

    </main>

    <footer class="text-center p-6 text-gray-400 text-sm">
        <p>Â© 2025 SYF-CBTS Spin & Quiz Game</p>
    </footer>

    <script>
        // Initialize Icons
        lucide.createIcons();

        // --- Configuration ---
        const colors = [
            '#1F3558', // Deep navy background (Player 1)
            '#2BE4D3', // Bright aqua/cyan text (Player 2)
            '#1A2A44', // Even darker navy gradient area(Player 3)
            '#3EA7A0', // Secondary ton-500 (Player 4)
            '#eab308', // Yellow-500 (Player 5)
            '#ec4899'  // Pink-500 (Player 6)
        ];

        // Lighter versions for backgrounds
        const lightColors = [
            '#fef2f2',
            '#ecfeff',
            '#eff6ff',
            '#f0fdf4',
            '#fefce8',
            '#fdf2f8'
        ];

        // Linked Question Sets (Mapped to Wheel Indices 0-5)
        // Each set now contains 15 questions
        const fixedQuestionSets = [
            // Index 0 (Default: "Incident Dectectives) - Incidents
            [
                {
                    q: "Can you guess how many incidents did network team close in 2025?",
                    a: ""
                },
                {
                    q: "Can you guess how many hours of tech engagements was logged by network team in 2025?",
                    a: ""
                },
                {
                    q: "Can you guess how many P1 incidents network team received in the year of 2025?",
                    a: ""
                },
                {
                    q: "Can you guess which type of incidents did network team get the most?",
                    a: ""
                },
                {
                    q: "Can you guess how many firewall changes did the network implement?",
                    a: ""
                },
                {
                    q: "When a network or application issue is reported, how do we ensure it is tracked, assigned and resolved properly?",
                    a: ""
                },
                {
                    q: "What is SYF standard change window timings?",
                    a: ""
                },
                {
                    q: "Can you guess how many breakfix changes were done by the network team in 2025?",
                    a: ""
                }
            ],
            // Index 1 (Default: Network Ninja) - Network Ninja
            [
                {
                    q: "What are the two WIFI SSID we use in HKC office?",
                    a: "Bold & Friends"
                },
                {
                    q: "How many physical data centers we have for Syf?",
                    a: "2 (Dallas & Phoenix)"
                },
                {
                    q: "What are the three ISPs which we use on HKC?",
                    a: "Tata, Airtel, Jio"
                },
                {
                    q: "Which monitoring tool is used for monitoring network health in Syf?",
                    a: "SolarWinds"
                },
                {
                    q: "Which vendor powers Syf SDWAN brain?",
                    a: "Fortinet"
                },
                {
                    q: "Which vendor powers Syf firewall brain?",
                    a: "Palo Alto"
                },
                {
                    q: "How many business centers does Syf have in APAC region?",
                    a: "HKC and Philippines"
                },
                {
                    q: "How do we ensure the business continues even when one ISP goes down at any location in Syf office?",
                    a: "Fortinet SDWAN takes care of automatic failover to other available ISPs"
                },
                {
                    q: "Which vendor powers Syf loadbalancer brain?",
                    a: "Avi Broadcom loadbalancer"
                },
                {
                    q: "If the entire Syf DC loses power but your apps are still working, who is running them?",
                    a: "AWS, Azure clouds"
                }
            ],
            // Index 2 (Default: Network Automation) - Network Automation
            [
            {
                q: "What is Netauto?",
                a: ""
            },
            {
                q: "What is NIAC?",
                a: ""
            },
            {
                q: "What are the responsibilities of automation team?",
                a: ""
            },
            {
                q: "What is a workflow?",
                a: ""
            },
            {
                q: "How many workflows we have automated?",
                a: ""
            },
            {
                q: "What is the front-end technology we use?",
                a: ""
            },
            {
                q: "What is the backend technology we use?",
                a: ""
            },
            {
                q: "What is No-Touch changes mean?",
                a: ""
            },
            {
                q: "How can we automate device configurations?",
                a: ""
            },
            {
                q: "What database we use?",
                a: ""
            },
            {
                q: "What method of development we follow?",
                a: ""
            },
            {
                q: "How many integrations we had done so far?",
                a: ""
            },
            {
                q: "What are the logging mechanisms we use?",
                a: ""
            },
            {
                q: "Have we used AI in the automation?",
                a: ""
            },
            {
                q: "What are the clouds we integrated?",
                a: ""
            }
            ],

            // Index 3 (Default: CEG) - CEG
            [
            {
                q: "What is Netauto?",
                a: ""
            },
            {
                q: "What is NIAC?",
                a: ""
            },
            {
                q: "What are the responsibilities of automation team?",
                a: ""
            },
            {
                q: "What is a workflow?",
                a: ""
            },
            {
                q: "How many workflows we have automated?",
                a: ""
            },
            {
                q: "What is the front-end technology we use?",
                a: ""
            },
            {
                q: "What is the backend technology we use?",
                a: ""
            },
            {
                q: "What is No-Touch changes mean?",
                a: ""
            },
            {
                q: "How can we automate device configurations?",
                a: ""
            },
            {
                q: "What database we use?",
                a: ""
            },
            {
                q: "What method of development we follow?",
                a: ""
            },
            {
                q: "How many integrations we had done so far?",
                a: ""
            },
            {
                q: "What are the logging mechanisms we use?",
                a: ""
            },
            {
                q: "Have we used AI in the automation?",
                a: ""
            },
            {
                q: "What are the clouds we integrated?",
                a: ""
            }
            ],
            // Index 4 (Default: NSS) - NSS
            [
            {
                q: "What is Netauto?",
                a: ""
            },
            {
                q: "What is NIAC?",
                a: ""
            },
            {
                q: "What are the responsibilities of automation team?",
                a: ""
            },
            {
                q: "What is a workflow?",
                a: ""
            },
            {
                q: "How many workflows we have automated?",
                a: ""
            },
            {
                q: "What is the front-end technology we use?",
                a: ""
            },
            {
                q: "What is the backend technology we use?",
                a: ""
            },
            {
                q: "What is No-Touch changes mean?",
                a: ""
            },
            {
                q: "How can we automate device configurations?",
                a: ""
            },
            {
                q: "What database we use?",
                a: ""
            },
            {
                q: "What method of development we follow?",
                a: ""
            },
            {
                q: "How many integrations we had done so far?",
                a: ""
            },
            {
                q: "What are the logging mechanisms we use?",
                a: ""
            },
            {
                q: "Have we used AI in the automation?",
                a: ""
            },
            {
                q: "What are the clouds we integrated?",
                a: ""
            }
         
            ]


        ];

        // --- Wheel Logic ---
        let names = [];
        const canvas = document.getElementById('wheelCanvas');
        const ctx = canvas.getContext('2d');
        let currentAngle = 0;
        let isSpinning = false;
        let spinVelocity = 0;
        let spinDecay = 0.985;
        let animationFrameId;

        function getNamesFromInputs() {
            const inputs = document.querySelectorAll('.name-input');
            return Array.from(inputs).map(input => input.value.trim() || "Player");
        }

        function toggleEdit() {
            const panel = document.getElementById('editPanel');
            panel.classList.toggle('hidden');
        }

        function updateNames() {
            names = getNamesFromInputs();
            document.getElementById('editPanel').classList.add('hidden');
            resetGameUI();
            drawWheel();
        }

        function drawWheel() {
            const numSegments = names.length;
            const arcSize = (2 * Math.PI) / numSegments;
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const radius = canvas.width / 2 - 10;

            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Draw Segments
            for (let i = 0; i < numSegments; i++) {
                const angle = currentAngle + i * arcSize;

                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.arc(centerX, centerY, radius, angle, angle + arcSize);
                ctx.fillStyle = colors[i % colors.length];
                ctx.fill();
                ctx.stroke();

                // Draw Text
                ctx.save();
                ctx.translate(centerX, centerY);
                ctx.rotate(angle + arcSize / 2);
                ctx.textAlign = "right";
                ctx.fillStyle = "white";
                ctx.textBaseline = "middle"; // Centers text vertically in wedge
                ctx.shadowColor = "rgba(0,0,0,0.3)";
                ctx.shadowBlur = 4;

                // Dynamic Font Scaling
                let fontSize = 24;
                ctx.font = `bold ${fontSize}px Poppins`;
                const maxW = radius - 70; // Available width (radius - outer padding - center hub)
                const text = names[i];

                // Reduce font size until it fits
                while (ctx.measureText(text).width > maxW && fontSize > 8) {
                    fontSize--;
                    ctx.font = `bold ${fontSize}px Poppins`;
                }

                ctx.fillText(text, radius - 20, 0);
                ctx.restore();
            }

            // Draw Center Hub
            ctx.beginPath();
            ctx.arc(centerX, centerY, 40, 0, 2 * Math.PI);
            ctx.fillStyle = "white";
            ctx.fill();
            ctx.lineWidth = 4;
            ctx.strokeStyle = "#E5E7EB";
            ctx.stroke();

            // Draw Center Text
            ctx.fillStyle = "#333";
            ctx.font = "bold 14px Poppins";
            ctx.textAlign = "center";
            ctx.textBaseline = "alphabetic"; // Reset baseline for center text
            ctx.fillText("VS", centerX, centerY + 5);
        }

        function spinWheel() {
            if (isSpinning) return;

            // Reset UI for new spin
            document.getElementById('result').innerText = "Spinning...";
            document.getElementById('question-section').style.borderColor = "#d1d5db"; // gray-300
            document.getElementById('locked-state').classList.remove('hidden');
            document.getElementById('questions-list').classList.add('hidden');
            document.getElementById('player-badge').classList.add('hidden');
            document.getElementById('q-title-text').innerText = "Questions Panel";
            document.getElementById('q-subtitle').innerText = "Spinning...";

            isSpinning = true;
            document.getElementById('spinBtn').classList.add('opacity-50', 'cursor-not-allowed');

            spinVelocity = Math.random() * 0.4 + 0.4;

            animateSpin();
        }

        function animateSpin() {
            spinVelocity *= spinDecay;
            currentAngle += spinVelocity;

            if (currentAngle >= 2 * Math.PI) {
                currentAngle -= 2 * Math.PI;
            }

            drawWheel();

            if (spinVelocity > 0.002) {
                animationFrameId = requestAnimationFrame(animateSpin);
            } else {
                stopSpin();
            }
        }

        function stopSpin() {
            cancelAnimationFrame(animationFrameId);
            isSpinning = false;
            spinVelocity = 0;
            document.getElementById('spinBtn').classList.remove('opacity-50', 'cursor-not-allowed');

            const numSegments = names.length;
            const arcSize = (2 * Math.PI) / numSegments;

            // Calculate winner
            const normalizedAngle = (2 * Math.PI - currentAngle % (2 * Math.PI)) % (2 * Math.PI);
            const index = Math.floor(normalizedAngle / arcSize);

            const winnerName = names[index];
            const winnerColor = colors[index % colors.length];
            const winnerBgColor = lightColors[index % lightColors.length];

            // Update Result Text
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = `<span style="color:${winnerColor}">${winnerName}</span>`;

            // Trigger Question Assignment with specific INDEX
            assignQuestionsTo(winnerName, winnerColor, winnerBgColor, index);
        }

        // --- Question Logic ---

        // Fisher-Yates Shuffle
        function shuffle(array) {
            let currentIndex = array.length, randomIndex;
            // While there remain elements to shuffle.
            while (currentIndex != 0) {
                // Pick a remaining element.
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex--;
                // And swap it with the current element.
                [array[currentIndex], array[randomIndex]] = [
                    array[randomIndex], array[currentIndex]];
            }
            return array;
        }

        function assignQuestionsTo(name, mainColor, bgColor, index) {
            const section = document.getElementById('question-section');
            const lockedState = document.getElementById('locked-state');
            const listContainer = document.getElementById('questions-list');
            const headerBadge = document.getElementById('step-2-badge');
            const playerBadge = document.getElementById('player-badge');
            const titleText = document.getElementById('q-title-text');
            const subtitle = document.getElementById('q-subtitle');

            // 1. Unlock Section
            lockedState.classList.add('hidden');
            listContainer.classList.remove('hidden');
            listContainer.classList.add('fade-in');

            // 2. Style Section based on Winner
            section.style.borderColor = mainColor;
            headerBadge.style.backgroundColor = mainColor;
            headerBadge.style.color = "white";

            // 3. Update Header Info
            titleText.innerText = `Questions for ${name}`;
            subtitle.innerText = `${name}, please choose a card below to answer.`;

            playerBadge.innerText = name;
            playerBadge.style.backgroundColor = mainColor;
            playerBadge.classList.remove('hidden');

            // 4. Generate Questions based on INDEX
            listContainer.innerHTML = "";

            // Get full pool for this player
            const playerPool = fixedQuestionSets[index] || [];

            // Shuffle and pick 5
            const shuffledPool = shuffle([...playerPool]);
            const selectedQuestions = shuffledPool.slice(0, 4);

            selectedQuestions.forEach((item, i) => {
                const card = document.createElement('div');
                // Dynamic border color on hover
                card.className = "border-l-4 rounded-r-lg shadow-sm bg-white overflow-hidden transition-all duration-200 hover:shadow-md";
                card.style.borderLeftColor = mainColor;

                card.innerHTML = `
                    <button class="w-full text-left p-4 focus:outline-none flex justify-between items-center group transition hover:bg-gray-50" onclick="toggleAnswer('ans-${i}', this, '${mainColor}', '${bgColor}')">
                        <div>
                            <span class="text-xs font-bold uppercase tracking-wide text-gray-400 mb-1 block">Question for ${name}</span>
                            <span class="font-medium text-gray-800 text-lg">${item.q}</span>
                        </div>
                        <div class="w-8 h-8 rounded-full flex items-center justify-center transition-colors duration-200" style="color:${mainColor}">
                           <i data-lucide="chevron-down"></i>
                        </div>
                    </button>
                    <div id="ans-${i}" class="answer-panel px-4 bg-gray-50">
                        <div class="pb-4 text-gray-800 font-medium border-t border-gray-100 pt-3 flex items-start gap-2">
                             <i data-lucide="check-circle-2" class="w-5 h-5 text-green-500 mt-0.5"></i>
                             <span>${item.a}</span>
                        </div>
                    </div>
                `;
                listContainer.appendChild(card);
            });

            // Re-init icons for new content
            lucide.createIcons();
        }

        function toggleAnswer(id, btn, activeColor, activeBg) {
            const panel = document.getElementById(id);
            const iconContainer = btn.querySelector('div:last-child');
            const icon = iconContainer.querySelector('svg');

            if (panel.classList.contains('open')) {
                // Close
                panel.classList.remove('open');
                iconContainer.style.backgroundColor = "transparent";
                iconContainer.style.color = activeColor;
                iconContainer.innerHTML = '<i data-lucide="chevron-down"></i>';
                btn.classList.remove('bg-gray-50');
            } else {
                // Open
                panel.classList.add('open');
                iconContainer.style.backgroundColor = activeColor;
                iconContainer.style.color = "white";
                iconContainer.innerHTML = '<i data-lucide="chevron-up"></i>';
                btn.classList.add('bg-gray-50');
            }
            lucide.createIcons();
        }

        function resetGameUI() {
            document.getElementById('result').innerText = "";
            document.getElementById('question-section').style.borderColor = "#d1d5db"; // gray-300
            document.getElementById('locked-state').classList.remove('hidden');
            document.getElementById('questions-list').classList.add('hidden');
            document.getElementById('player-badge').classList.add('hidden');
            document.getElementById('q-title-text').innerText = "Questions Panel";
            document.getElementById('step-2-badge').style.backgroundColor = "#f3f4f6";
            document.getElementById('step-2-badge').style.color = "#4b5563";
            document.getElementById('q-subtitle').innerText = "Spin the wheel to assign questions to a player.";
            currentAngle = 0;
            drawWheel();
        }

        function resetGame() {
            resetGameUI();
        }

        // --- Init ---
        window.onload = function () {
            updateNames();
        };

    </script>
</body>

</html>
