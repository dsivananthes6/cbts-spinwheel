<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spionvation Hub by CBTS</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f3f4f6;
        }

        .wheel-container {
            position: relative;
            width: 350px;
            height: 350px;
            margin: 0 auto;
        }

        canvas {
            width: 100%;
            height: 100%;
            transition: transform 0.1s;
        }

        .pointer {
            position: absolute;
            top: 50%;
            right: -20px;
            transform: translateY(-50%);
            width: 0;
            height: 0;
            border-top: 20px solid transparent;
            border-bottom: 20px solid transparent;
            border-right: 30px solid #ef4444;
            /* Changed to bright red */
            /* Pointing left */
            z-index: 10;
            filter: drop-shadow(2px 2px 2px rgba(0, 0, 0, 0.3));
            /* Added shadow for depth */
        }

        /* Hide scrollbar for clean look */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }

        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .answer-panel {
            transition: max-height 0.3s ease-out, opacity 0.3s ease-out, padding 0.3s ease;
            max-height: 0;
            opacity: 0;
            overflow: hidden;
        }

        .answer-panel.open {
            max-height: 200px;
            opacity: 1;
            padding-top: 0.75rem;
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .locked-overlay {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(2px);
        }

        .bg-cbts-900 {
            --tw-bg-opacity: 1;
            background-color: #1F3558;
        }
    </style>
</head>

<body class="text-gray-800 min-h-screen flex flex-col">

    <!-- Header -->
    <header class="bg-cbts-900 text-white p-4 shadow-lg">
        <div class="max-w-5xl mx-auto flex justify-between items-center">
            <div class="flex items-center gap-2">
                <i data-lucide="circle-dashed" class="w-8 h-8 text-pink-500"></i>
                <h1 class="text-2xl font-bold tracking-wider">Spionvation Hub by CBTS</h1>
            </div>
            <button onclick="resetGame()"
                class="text-sm bg-indigo-700 hover:bg-indigo-600 px-4 py-2 rounded-lg border border-indigo-500 transition flex items-center gap-2">
                <i data-lucide="rotate-ccw" class="w-4 h-4"></i> Reset
            </button>
        </div>
    </header>

    <main class="flex-grow p-4 md:p-8 max-w-6xl mx-auto w-full grid grid-cols-1 lg:grid-cols-2 gap-8 items-start">

        <!-- Left Column: The Wheel -->
        <section class="flex flex-col items-center bg-white p-6 rounded-2xl shadow-xl border-t-4 border-indigo-500">
            <div class="w-full flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold text-gray-700 flex items-center gap-2">
                    <span
                        class="bg-indigo-100 text-indigo-700 w-8 h-8 rounded-full flex items-center justify-center text-sm">1</span>
                    Spin to know. Learn to grow
                </h2>
                <!-- Edit Names Toggle -->
                <!-- <button onclick="toggleEdit()" class="text-xs text-gray-500 hover:text-indigo-600 underline">Edit
                    Names</button> -->
            </div>

            <!-- Edit Panel (Hidden by default) -->
            <div id="editPanel" class="hidden w-full mb-4 bg-gray-50 p-4 rounded-lg border border-gray-200">
                <h3 class="text-sm font-semibold mb-2">Player Names</h3>
                <div class="grid grid-cols-2 gap-2 mb-2">
                    <input type="text" class="name-input border rounded p-2 text-sm" value="Incident Dectectives">
                    <input type="text" class="name-input border rounded p-2 text-sm" value="Network Ninja">
                    <input type="text" class="name-input border rounded p-2 text-sm" value="Automation Avengers">
                    <input type="text" class="name-input border rounded p-2 text-sm" value="SharePoint Smashers">
                    <input type="text" class="name-input border rounded p-2 text-sm" value="Cloud Commanders">

                </div>
                <button onclick="updateNames()"
                    class="w-full bg-gray-800 text-white py-2 rounded text-sm hover:bg-gray-900">Update Wheel</button>
            </div>

            <div class="wheel-container mb-6">
                <canvas id="wheelCanvas" width="500" height="500"></canvas>
                <div class="pointer"></div>
            </div>

            <button id="spinBtn" onclick="spinWheel()"
                class="w-full max-w-xs bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white font-bold py-3 px-8 rounded-full shadow-lg transform transition hover:scale-105 active:scale-95 text-lg flex items-center justify-center gap-2">
                <i data-lucide="dices" class="w-5 h-5"></i> SPIN NOW
            </button>

            <div id="result"
                class="h-8 mt-4 text-xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-indigo-600 to-purple-600 text-center transition-all duration-300">
            </div>
        </section>

        <!-- Right Column: The Questions (Locked initially) -->
        <section id="question-section"
            class="relative flex flex-col bg-white rounded-2xl shadow-xl overflow-hidden min-h-[400px] transition-all duration-500 border-t-4 border-gray-300">

            <!-- Header for Question Section -->
            <div id="question-header" class="p-6 border-b border-gray-100 transition-colors duration-300">
                <div class="flex justify-between items-center">
                    <h2 class="text-xl font-bold text-gray-700 flex items-center gap-2">
                        <span
                            class="bg-gray-100 text-gray-600 w-8 h-8 rounded-full flex items-center justify-center text-sm transition-colors duration-300"
                            id="step-2-badge">2</span>
                        <span id="q-title-text">Questions Panel</span>
                    </h2>
                    <span id="player-badge"
                        class="hidden text-xs font-bold uppercase tracking-wider text-white px-3 py-1 rounded-full shadow-sm">
                        <!-- Player Name Injected Here -->
                    </span>
                </div>
                <p id="q-subtitle" class="text-sm text-gray-500 mt-2">Spin the wheel .
                </p>
            </div>

            <!-- Content Area -->
            <div class="relative flex-grow p-6 bg-gray-50">

                <!-- Locked State Overlay -->
                <div id="locked-state"
                    class="absolute inset-0 z-10 flex flex-col items-center justify-center text-center p-6 bg-white/50 backdrop-blur-sm">
                    <div class="bg-white p-4 rounded-full shadow-md mb-3">
                        <i data-lucide="lock" class="w-8 h-8 text-gray-400"></i>
                    </div>
                    <h3 class="text-lg font-semibold text-gray-600">Waiting for Spinner...</h3>
                    <p class="text-sm text-gray-400 max-w-xs mt-1">Spin the wheel </p>
                </div>

                <!-- Questions List (Hidden initially) -->
                <div id="questions-list" class="space-y-3 hidden">
                    <!-- Questions injected here by JS -->
                </div>
            </div>
        </section>

    </main>

    <footer class="text-center p-6 text-gray-400 text-sm">
        <p>Â© 2025 Spionvation Hub by CBTS</p>
    </footer>

    <script>
        // Initialize Icons
        lucide.createIcons();

        // --- Configuration ---
        const colors = [
            '#1F3558', // Deep navy background (Player 1)
            '#2BE4D3', // Bright aqua/cyan text (Player 2)
            '#1A2A44', // Even darker navy gradient area(Player 3)
            '#3EA7A0', // Secondary ton-500 (Player 4)
            '#eab308', // Yellow-500 (Player 5)
            '#ec4899'  // Pink-500 (Player 6)
        ];

        // Icons corresponding to each slice index
        const teamIcons = [
            'ðŸ•µï¸', // Incident Detectives
            'ðŸ¥·', // Network Ninja
            'ðŸ¤–', // Automation Avengers
            'ðŸ”¨', // SharePoint Smashers
            'â˜ï¸', // Cloud Commanders
            'âš¡'  // Extra
        ];

        // Lighter versions for backgrounds
        const lightColors = [
            '#fef2f2',
            '#ecfeff',
            '#eff6ff',
            '#f0fdf4',
            '#fefce8',
            '#fdf2f8'
        ];

        // Linked Question Sets (Mapped to Wheel Indices 0-5)
        // Each set now contains 15 questions
        const fixedQuestionSets = [
            // Index 0 (Default: "Incident Dectectives) - Incidents
            [
                {
                    q: "Can you guess how many incidents did network team close in 2025?",
                    a: ""
                },
                {
                    q: "Can you guess how many hours of tech engagements was logged by network team in 2025?",
                    a: ""
                },
                {
                    q: "Can you guess how many P1 incidents network team received in the year of 2025?",
                    a: ""
                },
                {
                    q: "Can you guess which type of incidents did network team get the most?",
                    a: ""
                },
                {
                    q: "Can you guess how many firewall changes did the network implement?",
                    a: ""
                },
                {
                    q: "When a network or application issue is reported, how do we ensure it is tracked, assigned and resolved properly?",
                    a: ""
                },
                {
                    q: "What is SYF standard change window timings?",
                    a: ""
                },
                {
                    q: "Can you guess how many breakfix changes were done by the network team in 2025?",
                    a: ""
                }
            ],
            // Index 1 (Default: Network Ninja) - Network Ninja
            [
                {
                    q: "Do you know who is our cloud DC service provider?",
                    a: "Equinix"
                },
                {
                    q: "Who are the cloud service providers of Synchrony?",
                    a: "AWS and Azure"
                },
                {
                    q: "How many Synchrony hubs we have in Philippines?",
                    a: "2 - CEBU & Manila"
                },
                {
                    q: "Which proxy service we use in Synchrony?",
                    a: "Zscaler"
                },
                {
                    q: "Can you guess which CISCO product we use for wireless in Synchrony hub?",
                    a: "Cisco Meraki"
                },
                {
                    q: "Can you guess the ISPâ€™s name we use in Philippines hub?",
                    a: "Radius, Globe & PLDT"
                },
                {
                    q: "Which tool we use as log collector in Synchrony?",
                    a: "Splunk"
                },
                {
                    q: "Which team architects and builds load balancer change requests in Synchrony?",
                    a: "NLB Team"
                },
                {
                    q: "Which team architects and builds Zscaler change requests in Synchrony?",
                    a: "NAS Team"
                },
                {
                    q: "Which team architects and builds DNS change requests?",
                    a: "NIS Team"
                },
                {
                    q: "Which vendor powers Synchrony firewall brain?",
                    a: "PaloAlto"
                },
                {
                    q: "How many hubs does Synchrony have in APAC region?",
                    a: "3 - HKC, CEBU & Manila"
                },
                {
                    q: "How do we ensure the business continuity when one ISP fails at any Synchrony office location?",
                    a: "Automatic failover is configured in Fortinet SDWAN"
                },
                {
                    q: "Which product powers Synchrony load balancer brain?",
                    a: "Avi Broadcom load balancers"
                },
                {
                    q: "Can you guess how apps traffic will work if Synchrony DC loses power?",
                    a: "App traffic will flow through AWS and Azure clouds"
                },
                {
                    q: "Who are the three ISP which we use on HKC?",
                    a: "Tata, Airtel & JIO"
                },
                {
                    q: "Which Monitoring tool is used for monitoring network health in Synchrony?",
                    a: "SolarWinds"
                },
                {
                    q: "Which provider powers Synchrony SDWAN brain?",
                    a: "Fortinet"
                },
                {
                    q: "Can you guess which type of incidents did CBTS NOC get the most?",
                    a: "BGP Alerts"
                },
                {
                    q: "What are the two WIFI SSID we use in HKC office?",
                    a: "Bold & Friends"
                },
                {
                    q: "How many Physical data centers we have for Synchrony?",
                    a: "2 (Dallas & Phoenix)"
                }
            ],
            // Index 2 (Default: Network Automation) - Network Automation
            [
                { q: "What is NetAuto and what problem does it solve?", a: "NetAuto is an in-house platform that automates network operations to reduce manual effort, errors, and provisioning time." },
                { q: "What is NIAC and why is it important?", a: "NIAC is the Network Infrastructure as Code team who automates provisioning of network-specific cloud resources in AWS and Azure." },
                { q: "What are the core components of the NetAuto platform?", a: "Core components include the workflow engine, API layer, UI, database, and integration modules." },
                { q: "How is NetAuto architected?", a: "It follows a modular, scalable, API-driven, microservices-based architecture." },
                { q: "What are the design principles followed in NetAuto?", a: "Reliability, scalability, security, modularity, and reusability." },
                { q: "What is a No-Touch Change?", a: "An automated sequence that runs in the background to perform a network change without manual intervention." },
                { q: "How are workflows designed and maintained?", a: "Workflows are created using reusable templates and maintained through version control." },
                { q: "How do you handle workflow failures?", a: "Through automated error handling, retries, rollbacks, and alerting." },
                { q: "What is rollback in an automated workflow?", a: "Rollback automatically reverts changes when a failure is detected." },
                { q: "What are idempotent operations in automation?", a: "Operations that can be executed multiple times without altering the final outcome." },
                { q: "What front-end technologies are used in automation platforms?", a: "Angular." },
                { q: "What back-end technologies are typically used?", a: "Python." },
                { q: "What type of APIs are used in automation systems?", a: "Primarily RESTful APIs." },
                { q: "How do you manage version control?", a: "Using Bitbucket repositories." },
                { q: "What development methodology is followed?", a: "Agile and sprint-based development." },
                { q: "What is Infrastructure as Code (IaC)?", a: "Managing infrastructure using code instead of manual processes." },
                { q: "How are network device configurations automated?", a: "Using templates, scripts, APIs, and CLI-based automation tools." },
                { q: "What is configuration drift and how do you prevent it?", a: "Configuration drift is deviation from standards, prevented using continuous compliance checks." },
                { q: "What is device compliance automation?", a: "Automated validation of device configurations against defined policies." },
                { q: "How do you validate pre-check and post-check conditions?", a: "By running automated scripts to verify system state before and after changes." },
                { q: "What types of third-party integrations are supported?", a: "ServiceNow, AVI, IPAM, monitoring tools, cloud platforms, and security tools." },
                { q: "How do you handle authentication for integrations?", a: "Using OAuth, tokens, and API keys." },
                { q: "What cloud platforms are commonly integrated?", a: "AWS and Microsoft Azure." },
                { q: "What is event-driven automation?", a: "Automation triggered automatically based on system events or alerts." },
                { q: "What logging mechanisms are used in automation platforms?", a: "Splunk logging and application logs." },
                { q: "How is auditing handled in automated environments?", a: "Through detailed change tracking and immutable audit trails." },
                { q: "What monitoring tools are integrated?", a: "SolarWinds." },
                { q: "How do you secure automation platforms?", a: "By implementing RBAC, encryption, and secure APIs." },
                { q: "What is role-based access control (RBAC)?", a: "A security model that restricts system access based on user roles and groups." },
                { q: "How is AI used in network automation?", a: "For predictive analytics, intelligent alerting, and automated remediation." },
                { q: "What is the role of machine learning in infrastructure automation?", a: "To detect patterns, predict failures, and optimize performance." },
                { q: "What are predictive and self-healing networks?", a: "Networks that automatically detect, prevent, and resolve issues." },
                { q: "How do you measure automation success?", a: "By tracking time saved, error reduction, and operational efficiency." },
                { q: "What are the future enhancements planned?", a: "Expanding AI capabilities, adding more integrations, and increasing automation coverage." }
            ]
            ,

            // Index 3 (Default: SharePoint Smashers) - SharePoint Smashers
            [
                {
                    q: "What is the default OneDrive storage allocated to each user?",
                    a: "2TB"
                },
                {
                    q: "How much OneDrive storage has been used so far?",
                    a: "785 TB (Approx)"
                },
                {
                    q: "What is the total number of files stored in our OneDrive tenant?",
                    a: "147.42M (Approx)"
                },
                {
                    q: "What is the purpose of the OneDrive Sync Client?",
                    a: "Syncs our files and data between the cloud and computer, for offline access."
                },
                {
                    q: "Who has the ability to control OneDrive file access?",
                    a: "OneDrive site / file owners"
                },
                {
                    q: "Can you guess the total number of SharePoint sites in our Synchrony tenant?",
                    a: "6489"
                },
                {
                    q: "Guess how often the Guest users are renewed in our tenant?",
                    a: "180 days / 6 months"
                },
                {
                    q: "Can you guess the total number of files stored in SharePoint Online?",
                    a: "51.51M (Approx)"
                },
                {
                    q: "How many workflows were created in the last 6 months?",
                    a: "440"
                },
                {
                    q: "Who can request to create a New SharePoint/Team in Synchrony?",
                    a: "Internal Synchrony employees"
                },
                {
                    q: "How many Power Apps forms were created in the last 6 months?",
                    a: "448"
                },
                {
                    q: "Which feature helps track changes made to a file?",
                    a: "Version History"
                },
                {
                    q: "Can site owners transfer ownership of a site?",
                    a: "Yes, they can"
                },
                {
                    q: "Can you guess the total SharePoint Online storage used in our tenant?",
                    a: "240 TB (Approx)"
                },
                {
                    q: "Where do we register guest users in our tenant?",
                    a: "In the GUM portal (Guest User Management)"
                }
            ],
            // Index 4 (Default: Cloud Commanders) - Cloud Commanders
           [
  {
    q: "What was the highest number of customer requests closed by the IAM OPS Team, and can you guess which month?",
    a: "173, in October 2025"
  },
  {
    q: "Do you know the ServiceNow queue name for IAM BAU Team?",
    a: "BAUIAMOP"
  },
  {
    q: "Which project management or tracking tool is used to plan, track, manage, and release work?",
    a: "Jira"
  },
  {
    q: "What is cspack in Azure?",
    a: "It is a command-line tool that is used for generating service package files."
  },
  {
    q: "What is the accuracy rate in delivering customer requirements for the BAU Team over the past 12 months?",
    a: "98.34%"
  },
  {
    q: "How many times was the IAM OPS Team able to deliver 100+ requests in the last 12 months?",
    a: "8 times"
  },
  {
    q: "What is a Pod in Kubernetes?",
    a: "A Pod is the smallest deployable unit in Kubernetes. It represents one or more containers running in a shared environment."
  },
  {
    q: "What is NSG?",
    a: "NSG stands for Network Security Group that has ACL rules to allow or deny network traffic to subnets or NICs."
  },
  {
    q: "What is the best Azure solution for executing the code without a server?",
    a: "Azure Functions service"
  },
  {
    q: "Which IAC solution is majorly used by the Synchrony Team?",
    a: "CloudFormation"
  },
  {
    q: "What CI/CD solution is used by the Synchrony IAM Team?",
    a: "Jenkins"
  },
  {
    q: "Which source code editor tool is used by the Synchrony team?",
    a: "Visual Studio Code"
  },
  {
    q: "What is the name of the IT Service Management tool used by the team?",
    a: "ServiceNow"
  },
  {
    q: "What is the total number of SOPs followed by the team?",
    a: "15"
  },
  {
    q: "Which code hosting and collaboration tool is used by the team?",
    a: "Bitbucket"
  },
  {
    q: "What is the primary responsibility of the Cloud IAM Operations Team?",
    a: "Implementing IAM policies, roles, and access controls for cloud resources"
  },
  {
    q: "What is the goal of IAM in cloud security?",
    a: "Ensuring the right individuals have the right access to the right resources"
  },
  {
    q: "Which activity ensures the teamâ€™s processes are standardized?",
    a: "By following the SOPs"
  },
  {
    q: "How does the team ensure correct permissions while delivering customer requirements?",
    a: "Technical Leads review each PR submitted by IAM OPS engineers."
  }
]



        ];

        // --- Wheel Logic ---
        let names = [];
        const canvas = document.getElementById('wheelCanvas');
        const ctx = canvas.getContext('2d');
        let currentAngle = 0;
        let isSpinning = false;
        let spinVelocity = 0;
        let spinDecay = 0.985;
        let animationFrameId;

        function getNamesFromInputs() {
            const inputs = document.querySelectorAll('.name-input');
            return Array.from(inputs).map(input => input.value.trim() || "Player");
        }

        function toggleEdit() {
            const panel = document.getElementById('editPanel');
            panel.classList.toggle('hidden');
        }

        function updateNames() {
            names = getNamesFromInputs();
            document.getElementById('editPanel').classList.add('hidden');
            resetGameUI();
            drawWheel();
        }

        function drawWheel() {
            const numSegments = names.length;
            const arcSize = (2 * Math.PI) / numSegments;
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const radius = canvas.width / 2 - 10;

            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Draw Segments
            for (let i = 0; i < numSegments; i++) {
                const angle = currentAngle + i * arcSize;

                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.arc(centerX, centerY, radius, angle, angle + arcSize);
                ctx.fillStyle = colors[i % colors.length];
                ctx.fill();
                ctx.stroke();

                // Draw Text & Icon
                ctx.save();
                ctx.translate(centerX, centerY);
                ctx.rotate(angle + arcSize / 2);
                ctx.textAlign = "right";
                ctx.fillStyle = "white";
                ctx.textBaseline = "middle"; // Centers text vertically in wedge
                ctx.shadowColor = "rgba(0,0,0,0.3)";
                ctx.shadowBlur = 4;

                const name = names[i];
                const icon = teamIcons[i % teamIcons.length];

                // Split text into two lines based on first space
                const words = name.split(' ');
                let line1 = words[0];
                let line2 = words.slice(1).join(' ');

                // Dynamic Font Scaling
                let fontSize = 24;
                ctx.font = `bold ${fontSize}px Poppins`;

                // Max width allowed in the slice
                const maxW = radius - 70;

                // Measure widths
                // We estimate the width of Line 1 + Icon + Padding
                let iconWidth = fontSize + 10;
                let line1Width = ctx.measureText(line1).width;
                let line2Width = ctx.measureText(line2).width;

                // Check if widest part fits
                let totalW1 = line1Width + iconWidth;
                let totalW2 = line2Width;

                // Reduce font size until it fits
                while ((totalW1 > maxW || totalW2 > maxW) && fontSize > 10) {
                    fontSize--;
                    ctx.font = `bold ${fontSize}px Poppins`;
                    iconWidth = fontSize + 10;
                    line1Width = ctx.measureText(line1).width;
                    line2Width = ctx.measureText(line2).width;
                    totalW1 = line1Width + iconWidth;
                    totalW2 = line2Width;
                }

                // Drawing logic
                // If we have a second line, stack them.
                if (line2) {
                    // Line 1 (Upper)
                    ctx.fillText(line1, radius - 20, -fontSize * 0.6);
                    // Icon (Left of Line 1)
                    ctx.fillText(icon, radius - 20 - line1Width - 10, -fontSize * 0.6);
                    // Line 2 (Lower)
                    ctx.fillText(line2, radius - 20, fontSize * 0.7);
                } else {
                    // Single line case
                    ctx.fillText(line1, radius - 20, 0);
                    ctx.fillText(icon, radius - 20 - line1Width - 10, 0);
                }

                ctx.restore();
            }

            // Draw Center Hub
            ctx.beginPath();
            ctx.arc(centerX, centerY, 40, 0, 2 * Math.PI);
            ctx.fillStyle = "white";
            ctx.fill();
            ctx.lineWidth = 4;
            ctx.strokeStyle = "#E5E7EB";
            ctx.stroke();

            // Draw Center Text
            ctx.fillStyle = "#333";
            ctx.font = "bold 14px Poppins";
            ctx.textAlign = "center";
            ctx.textBaseline = "alphabetic"; // Reset baseline for center text
            ctx.fillText("CBTS", centerX, centerY + 5);
        }

        function spinWheel() {
            if (isSpinning) return;

            // Reset UI for new spin
            document.getElementById('result').innerText = "Spinning...";
            document.getElementById('question-section').style.borderColor = "#d1d5db"; // gray-300
            document.getElementById('locked-state').classList.remove('hidden');
            document.getElementById('questions-list').classList.add('hidden');
            document.getElementById('player-badge').classList.add('hidden');
            document.getElementById('q-title-text').innerText = "Questions Panel";
            document.getElementById('q-subtitle').innerText = "Spinning...";

            isSpinning = true;
            document.getElementById('spinBtn').classList.add('opacity-50', 'cursor-not-allowed');

            spinVelocity = Math.random() * 0.4 + 0.4;

            animateSpin();
        }

        function animateSpin() {
            spinVelocity *= spinDecay;
            currentAngle += spinVelocity;

            if (currentAngle >= 2 * Math.PI) {
                currentAngle -= 2 * Math.PI;
            }

            drawWheel();

            if (spinVelocity > 0.002) {
                animationFrameId = requestAnimationFrame(animateSpin);
            } else {
                stopSpin();
            }
        }

        function stopSpin() {
            cancelAnimationFrame(animationFrameId);
            isSpinning = false;
            spinVelocity = 0;
            document.getElementById('spinBtn').classList.remove('opacity-50', 'cursor-not-allowed');

            const numSegments = names.length;
            const arcSize = (2 * Math.PI) / numSegments;

            // Calculate winner
            const normalizedAngle = (2 * Math.PI - currentAngle % (2 * Math.PI)) % (2 * Math.PI);
            const index = Math.floor(normalizedAngle / arcSize);

            const winnerName = names[index];
            const winnerColor = colors[index % colors.length];
            const winnerBgColor = lightColors[index % lightColors.length];

            // Update Result Text
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = `<span style="color:${winnerColor}">${winnerName}</span>`;

            // Trigger Question Assignment with specific INDEX
            assignQuestionsTo(winnerName, winnerColor, winnerBgColor, index);
        }

        // --- Question Logic ---

        // Fisher-Yates Shuffle
        function shuffle(array) {
            let currentIndex = array.length, randomIndex;
            // While there remain elements to shuffle.
            while (currentIndex != 0) {
                // Pick a remaining element.
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex--;
                // And swap it with the current element.
                [array[currentIndex], array[randomIndex]] = [
                    array[randomIndex], array[currentIndex]];
            }
            return array;
        }

        function assignQuestionsTo(name, mainColor, bgColor, index) {
            const section = document.getElementById('question-section');
            const lockedState = document.getElementById('locked-state');
            const listContainer = document.getElementById('questions-list');
            const headerBadge = document.getElementById('step-2-badge');
            const playerBadge = document.getElementById('player-badge');
            const titleText = document.getElementById('q-title-text');
            const subtitle = document.getElementById('q-subtitle');

            // 1. Unlock Section
            lockedState.classList.add('hidden');
            listContainer.classList.remove('hidden');
            listContainer.classList.add('fade-in');

            // 2. Style Section based on Winner
            section.style.borderColor = mainColor;
            headerBadge.style.backgroundColor = mainColor;
            headerBadge.style.color = "white";

            // 3. Update Header Info
            titleText.innerText = `Questions for ${name}`;
            subtitle.innerText = `${name}, please choose a card below to answer.`;

            playerBadge.innerText = name;
            playerBadge.style.backgroundColor = mainColor;
            playerBadge.classList.remove('hidden');

            // 4. Generate Questions based on INDEX
            listContainer.innerHTML = "";

            // Get full pool for this player
            const playerPool = fixedQuestionSets[index] || [];

            // Shuffle and pick 5
            const shuffledPool = shuffle([...playerPool]);
            const selectedQuestions = shuffledPool.slice(0, 4);

            selectedQuestions.forEach((item, i) => {
                const card = document.createElement('div');
                // Dynamic border color on hover
                card.className = "border-l-4 rounded-r-lg shadow-sm bg-white overflow-hidden transition-all duration-200 hover:shadow-md";
                card.style.borderLeftColor = mainColor;

                card.innerHTML = `
                    <button class="w-full text-left p-4 focus:outline-none flex justify-between items-center group transition hover:bg-gray-50" onclick="toggleAnswer('ans-${i}', this, '${mainColor}', '${bgColor}')">
                        <div>
                            <span class="text-xs font-bold uppercase tracking-wide text-gray-400 mb-1 block">Question for ${name}</span>
                            <span class="font-medium text-gray-800 text-lg">${item.q}</span>
                        </div>
                        <div class="w-8 h-8 rounded-full flex items-center justify-center transition-colors duration-200" style="color:${mainColor}">
                           <i data-lucide="chevron-down"></i>
                        </div>
                    </button>
                    <div id="ans-${i}" class="answer-panel px-4 bg-gray-50">
                        <div class="pb-4 text-gray-800 font-medium border-t border-gray-100 pt-3 flex items-start gap-2">
                             <i data-lucide="check-circle-2" class="w-5 h-5 text-green-500 mt-0.5"></i>
                             <span>${item.a}</span>
                        </div>
                    </div>
                `;
                listContainer.appendChild(card);
            });

            // Re-init icons for new content
            lucide.createIcons();
        }

        function toggleAnswer(id, btn, activeColor, activeBg) {
            const panel = document.getElementById(id);
            const iconContainer = btn.querySelector('div:last-child');
            const icon = iconContainer.querySelector('svg');

            if (panel.classList.contains('open')) {
                // Close
                panel.classList.remove('open');
                iconContainer.style.backgroundColor = "transparent";
                iconContainer.style.color = activeColor;
                iconContainer.innerHTML = '<i data-lucide="chevron-down"></i>';
                btn.classList.remove('bg-gray-50');
            } else {
                // Open
                panel.classList.add('open');
                iconContainer.style.backgroundColor = activeColor;
                iconContainer.style.color = "white";
                iconContainer.innerHTML = '<i data-lucide="chevron-up"></i>';
                btn.classList.add('bg-gray-50');
            }
            lucide.createIcons();
        }

        function resetGameUI() {
            document.getElementById('result').innerText = "";
            document.getElementById('question-section').style.borderColor = "#d1d5db"; // gray-300
            document.getElementById('locked-state').classList.remove('hidden');
            document.getElementById('questions-list').classList.add('hidden');
            document.getElementById('player-badge').classList.add('hidden');
            document.getElementById('q-title-text').innerText = "Questions Panel";
            document.getElementById('step-2-badge').style.backgroundColor = "#f3f4f6";
            document.getElementById('step-2-badge').style.color = "#4b5563";
            document.getElementById('q-subtitle').innerText = "Spin the wheel.";
            currentAngle = 0;
            drawWheel();
        }

        function resetGame() {
            resetGameUI();
        }

        // --- Init ---
        window.onload = function () {
            updateNames();
        };

    </script>
</body>

</html>
